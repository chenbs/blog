title: dns入门
date: 2016-06-19 17:40:00
tags:
- dns

# dns入门

阮一峰老师的：[DNS 原理入门](http://www.ruanyifeng.com/blog/2016/06/dns.html)讲的很清楚。

下面摘录一些知识点，详见[原文](http://www.ruanyifeng.com/blog/2016/06/dns.html)。

命令：`dig`

	dig math.stackexchange.com
	
上面的命令会输出六段信息：

* 第一段是查询参数和统计
* 第二段是查询内容
* 第三段是DNS服务器的答复
* 第四段显示stackexchange.com的NS记录（Name Server的缩写）		
* 第五段是上面四个域名服务器的IP地址
* 第六段是DNS服务器的一些传输信息


域名的层级结构如下：

	主机名.次级域名.顶级域名.根域名
	# 即
	host.sld.tld.root
	
DNS服务器根据域名的层级，进行分级查询。

需要明确的是，每一级域名都有自己的NS记录，NS记录指向该级域名的域名服务器。这些服务器知道下一级域名的各种记录。

所谓"分级查询"，就是从根域名开始，依次查询每一级域名的NS记录，直到查到最终的IP地址，过程大致如下。

* 从"根域名服务器"查到"顶级域名服务器"的NS记录和A记录（IP地址）
* 从"顶级域名服务器"查到"次级域名服务器"的NS记录和A记录（IP地址）
* 从"次级域名服务器"查出"主机名"的IP地址


域名与IP之间的对应关系，称为"`记录`"（record）

常见的DNS记录类型如下:

* A：地址记录（Address），返回域名指向的IP地址。
* NS：域名服务器记录（Name Server），返回保存下一级域名信息的服务器地址。该记录只能设置为域名，不能设置为IP地址。
* MX：邮件记录（Mail eXchange），返回接收电子邮件的服务器地址。
* CNAME：规范名称记录（Canonical Name），返回另一个域名，即当前查询的域名是另一个域名的跳转。
* PTR：逆向查询记录（Pointer Record），只用于从IP地址查询域名

	一般来说，为了服务的安全可靠，至少应该有两条`NS`记录，而`A`记录和`MX`记录也可以有多条，这样就提供了服务的冗余性，防止出现单点失败。

	`CNAME`记录主要用于域名的内部跳转，为服务器配置提供灵活性，用户感知不到

	`PTR`记录用于从IP地址反查域名




	

	
	